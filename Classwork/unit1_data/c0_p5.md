# c0. P5.js External Data

**NOTE:** [Check this link](https://github.com/processing/p5.js/wiki/Loading-external-files:-AJAX,-XML,-JSON) for a more comprehensive guide to loading external data with p5.

There are many different data formats and many ways to access external data files!
**AJAX** (Asynchronous JavaScript And XML) makes it possible to send and receive/load data files. p5.js has a variety of methods for using AJAX to retrieve files from a server:

* [loadJSON()](http://p5js.org/reference/#/p5/loadJSON)
* [loadTable()](http://p5js.org/reference/#/p5/loadTable)
* [loadStrings()](http://p5js.org/reference/#/p5/loadStrings)
* [loadXML()](http://p5js.org/reference/#/p5/loadXML)

## JSON

JSON (JavaScript Object Notation) is a means of storing data in key-value pairs that is easy for humans to write and easy for machines to parse. JSON uses the JavaScript syntax, but it is language independent. Here's a sample JSON file:

```JavaScript
{ "person1" : {
    "name": "Morgan",
    "age": "30",
    "location": "Boston",
    "desire": "Singing",
    "fear": "Violence"
  },
  "person2": {
    "name": "Joss",
    "age": "42",
    "location": "Boston",
    "desire": "Hiking",
    "fear": "Irrationality"
  }
}
```
### Exercise
Using the Pokémon JSON file (in the data folder), make a pie chart illustrating the percentage of the original 151 Pokémon that weigh more than Bulbasaur ("69").

```javascript
var pokemon;

function preload() {
   pokemon = loadJSON("data/pokemon.json");
}

function setup() {
   createCanvas(400, 400);
   noLoop();
   printTable();
}

function draw() {
   background(200);
   fill(0, 255, 0);
   var diameter = 100;
   arc(width / 2, height / 2, diameter, diameter, 0, percentBigger() * 2 * PI);
   fill(0, 0, 255);
   arc(width / 2, height / 2, diameter, diameter, percentBigger() * 2 * PI, 0);
}

function percentBigger() {
  var percent;
  // fill me out

  return percent;
}
```

## csv
Comma Separated Values (csv) files are another way to store and load data. Make sure there's a .csv filed saved in your project folder. Check out the [**loadTable()**](http://p5js.org/reference/#/p5/loadTable) function in the p5 reference for an example file.

### Exercise
Load the csv file pres_heights.csv. Make a bar chart representing the height of each president.


```javascript
var table;

function preload() {
   table = loadTable("data/pres_heights.csv", "csv", "header");
}

function setup() {
   createCanvas(1200, 400);
   colorMode(HSB, 100);
   noLoop();
}

function draw() {
   background(255);
   drawTable();
   drawKey();
}

function drawTable() {

   //cycle through the table
   var startSpace = 50;

   for (var r = 0; r < table.getRowCount(); r++) {
      console.log(table.getString(r, 1));

      // use map to get a good bar height
      var heightPres = parseInt(table.getString(r, 2));
      var barHeight = map(heightPres, getMinHeight(), getMaxHeight(), 50, height-50);

      // use map to set bar color to a gradient from red to green
      var barHue = map(heightPres, getMinHeight(), getMaxHeight(), 0, 30);

      // draw the bars
      fill(barHue, 100, 100);
      rect(r * 20+startSpace, startSpace, 20, barHeight);

      // draw text labels - rotate 90 degrees
      push();
      translate(r * 20 + 5 + startSpace, 60);
      rotate(radians(90));
      fill(0);
      stroke(0);
      text(table.getString(r, 1), 0, 0);
      pop();
   }
}

function drawKey() {
   line(40, 50, 40, height-50);
   for (var i = 50; i <= height-50; i++) {
      fill(0);
      stroke(0);
      var yVal = map(i, 50, height-50, 163, 193);
      if (yVal % 10 == 0) {
         line(30, i, 40, i);
         text(yVal, 10, i+5);
      }

   }
}

function getMinHeight() {
   var minH =  parseInt(table.getString(0, 2));;
   for (var r = 1; r < table.getRowCount(); r++) {
      if (parseInt(table.getString(r, 2)) < minH) {
         minH =  parseInt(table.getString(r, 2));
      }
   }
   console.log(minH);
   return minH;
}

function getMaxHeight() {
    var maxH =  parseInt(table.getString(0, 2));;
   for (var r = 1; r < table.getRowCount(); r++) {
      if (parseInt(table.getString(r, 2)) > maxH) {
         maxH =  parseInt(table.getString(r, 2));
      }
   }
    console.log(maxH);
   return maxH;
}
```
